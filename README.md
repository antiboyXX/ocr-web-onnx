# 🔍 OCR Web ONNX - 智能图文分离系统

## 🎯 项目简介

这是一个**神奇的图文分离工具**！就像魔法一样，只要上传一张包含文字的图片，系统就能：

- 🔍 **自动识别所有文字** - 无论中文还是英文
- ✂️ **智能分离图文** - 把文字从图片中"剪"出来
- 🎭 **创建文字掩码** - 标记出文字的位置
- 🎨 **修复原图** - 移除文字后智能填补背景
- 📊 **可视化结果** - 漂亮的图表展示识别结果

## ✨ 核心功能

### 📷 图片上传
- 支持拖拽上传
- 支持点击选择
- 自动验证文件格式
- 实时显示上传进度

### 🔍 文字识别
- **中英文混合识别** - 支持同时识别中文和英文
- **高精度识别** - 基于EasyOCR深度学习模型
- **置信度显示** - 每个文字都有可信度评分
- **位置标注** - 精确标记文字在图片中的位置

### ✂️ 图文分离
- **智能分离** - 自动将每个文字区域单独提取
- **保持原样** - 分离出的文字保持原有大小和清晰度
- **批量处理** - 一次性分离所有文字区域
- **编号管理** - 每个文字区域都有唯一编号

### 🎨 图像修复
- **三种算法** - 提供3种不同的修复效果
  - 🥇 **混合修复** - 最佳效果，推荐使用
  - 🥈 **Navier-Stokes** - 基于流体力学原理
  - 🥉 **Telea算法** - 快速修复算法
- **智能填补** - 移除文字后自动修复背景
- **无痕处理** - 修复后的图片看不出处理痕迹

### 📊 可视化展示
- **检测框标注** - 用不同颜色框标记每个文字
- **编号显示** - 每个文字区域都有清晰编号
- **结果对比** - 修复前后效果对比
- **统计信息** - 显示识别数量、置信度等

### 📥 结果下载
- **一键打包** - 所有结果文件打包成ZIP下载
- **单独下载** - 可以单独下载任意文件
- **多种格式** - 支持图片、文本、JSON等格式
- **文件命名** - 自动生成有意义的文件名

## 🛠️ 技术架构

### 后端技术
- **Python 3.9+** - 主要编程语言
- **Flask** - Web服务器框架，轻量级但功能强大
- **EasyOCR** - 文字识别引擎，支持80+种语言
- **OpenCV** - 图像处理库，处理图像操作
- **NumPy** - 数值计算库，处理图像数据
- **Matplotlib** - 可视化库，生成结果图表

### 前端技术
- **HTML5** - 网页结构，现代化设计
- **CSS3** - 样式设计，响应式布局
- **JavaScript ES6+** - 交互逻辑，异步处理
- **Fetch API** - 与后端通信
- **File API** - 处理文件上传

### 核心算法
- **CRAFT算法** - EasyOCR的文字检测算法
- **CRNN模型** - 文字识别神经网络
- **图像修复算法** - 多种修复技术结合
- **掩码生成** - 智能创建文字区域掩码

## 📦 安装指南

### 环境要求
```
操作系统: Windows 10/11, macOS, Linux
Python版本: 3.9 或更高版本
内存: 至少 4GB RAM (推荐 8GB)
硬盘: 至少 2GB 可用空间
```

### 安装步骤

1. **克隆项目**
```bash
git clone [项目地址]
cd OCR_Web_ONNX
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **启动服务**
```bash
python main_server.py
```

4. **访问网站**
```
本地访问: http://localhost:5000
局域网访问: http://你的IP:5000
```

## 🚀 使用教程

### 快速开始
1. **启动服务器** - 运行 `python main_server.py`
2. **打开网页** - 浏览器访问 `http://localhost:5000`
3. **上传图片** - 点击"选择图片"或拖拽图片到上传区域
4. **等待处理** - 系统自动处理，显示进度条
5. **查看结果** - 浏览识别文字、可视化结果、修复图片
6. **下载文件** - 点击下载按钮获取所有结果

### 详细操作

#### 📤 上传图片
- **支持格式**: JPG, PNG, GIF, WEBP
- **大小限制**: 最大 10MB
- **上传方式**: 
  - 点击"选择图片"按钮
  - 直接拖拽图片到上传区域
  - 自动显示图片预览

#### 🔍 查看识别结果
- **文字列表** - 显示所有识别出的文字
- **置信度** - 每个文字的可信度百分比
- **编号标记** - 点击文字可在图片上高亮显示
- **可视化图** - 彩色框标记所有文字位置

#### ✂️ 图文分离
- **自动分离** - 系统自动将每个文字单独提取
- **高清保存** - 分离后的文字保持原有清晰度
- **批量查看** - 网格形式展示所有分离结果
- **文字对应** - 每个分离图片显示对应的文字内容

#### 🎨 图像修复
- **多种算法** - 三种不同修复效果供选择
- **效果对比** - 原图、掩码、修复结果并排显示
- **最佳推荐** - 系统推荐最佳修复效果
- **高质量** - 修复后图片质量接近原图

#### 📥 下载结果
- **一键下载** - 点击"下载全部结果"获取ZIP压缩包
- **选择下载** - 可以单独下载任意文件
- **文件包含**:
  - 原始图片
  - 识别结果可视化图
  - 文字掩码图
  - 所有分离的文字图片
  - 三种修复后的图片
  - 文字识别结果文本文件
  - 处理概览图

## 📁 文件结构
```
OCR_Web_ONNX/
├── main_server.py          # 🚀 主服务器文件
├── index.html              # 🏠 网页界面
├── requirements.txt        # 📦 依赖列表
├── README.md              # 📝 说明文档
├── css/                   # 🎨 样式文件
│   ├── main.css           #     主要样式
│   └── components.css     #     组件样式
├── js/                    # ⚡ JavaScript文件
│   ├── main.js            #     主要逻辑
│   ├── image-processor.js #     图像处理
│   └── utils.js           #     工具函数
├── uploads/               # 📤 上传文件夹
├── results/               # 📥 结果文件夹
└── models/                # 🧠 模型配置
```

## ⚙️ 配置说明

### 服务器配置
```python
# main_server.py 中的关键配置
HOST = '0.0.0.0'          # 监听所有IP地址
PORT = 5000               # 端口号
DEBUG = True              # 调试模式
MAX_FILE_SIZE = 10MB      # 最大文件大小
```

### OCR参数配置
```python
# EasyOCR配置
LANGUAGES = ['ch_sim', 'en']  # 支持中文简体和英文
USE_GPU = False               # 是否使用GPU (需要CUDA)
CONFIDENCE_THRESHOLD = 0.3    # 置信度阈值
```

## 🔧 故障排除

### 常见问题

#### 🚫 服务器启动失败
**问题**: 运行 `python main_server.py` 报错
**解决**:
1. 检查Python版本: `python --version`
2. 安装依赖: `pip install -r requirements.txt`
3. 检查端口占用: `netstat -an | findstr :5000`

#### 📤 图片上传失败
**问题**: 选择图片后没有反应
**解决**:
1. 检查文件格式 (仅支持图片格式)
2. 检查文件大小 (不超过10MB)
3. 清除浏览器缓存
4. 检查网络连接

#### 🔍 识别效果不好
**问题**: 文字识别错误或遗漏
**解决**:
1. 使用高清晰度图片
2. 确保文字清晰可见
3. 避免图片过于倾斜
4. 文字颜色与背景对比度要够

#### 🌐 局域网无法访问
**问题**: 其他设备无法访问网站
**解决**:
1. 检查防火墙设置
2. 确认IP地址正确
3. 检查路由器设置
4. 尝试关闭防火墙测试

## 🚀 部署指南

### 本地部署
适合个人使用，关机后服务停止。

### 云服务器部署
适合长期使用，24小时在线服务。

**推荐云服务商**:
- 阿里云ECS
- 腾讯云CVM  
- 华为云ECS
- AWS EC2

**最低配置**:
- CPU: 1核
- 内存: 2GB
- 硬盘: 20GB
- 带宽: 1Mbps

### 内网穿透
使用ngrok等工具将本地服务暴露到公网。

## 📈 性能优化

### 提升识别速度
- 使用GPU加速 (需要NVIDIA显卡)
- 压缩图片尺寸
- 调整置信度阈值

### 提升识别精度
- 使用高清图片
- 预处理图片 (去噪、增强对比度)
- 调整OCR参数

### 提升服务性能
- 使用生产级服务器 (Gunicorn)
- 启用图片缓存
- 配置负载均衡

## 🛡️ 安全建议

### 基础安全
- 设置访问密码
- 限制上传文件类型
- 定期清理临时文件
- 监控系统资源使用

### 生产环境
- 使用HTTPS
- 配置防火墙
- 定期备份数据
- 设置访问日志

## 🤝 技术支持

### 获取帮助
- 查看详细日志输出
- 检查控制台错误信息
- 参考故障排除指南
- 联系技术支持

### 反馈建议
如果您有任何问题或建议，欢迎反馈！

## 📄 许可证

本项目基于 MIT 许可证开源。

## 🙏 致谢

感谢以下开源项目的支持：
- **EasyOCR** - 强大的OCR识别引擎
- **OpenCV** - 专业的计算机视觉库
- **Flask** - 优雅的Web框架
- **Matplotlib** - 强大的可视化工具

---

## 🎉 开始使用

现在您已经了解了这个项目的所有功能，赶快试试吧！

1. 启动服务: `python main_server.py`
2. 打开浏览器: `http://localhost:5000`
3. 上传您的第一张图片
4. 体验神奇的图文分离功能！

**祝您使用愉快！** ✨ 